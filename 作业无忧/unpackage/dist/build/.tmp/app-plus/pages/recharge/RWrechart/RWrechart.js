(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/recharge/RWrechart/RWrechart"],{"01d2":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement;e._self._c},r=[];a.d(t,"a",function(){return n}),a.d(t,"b",function(){return r})},"1ffb":function(e,t,a){"use strict";a.r(t);var n=a("9ff3"),r=a.n(n);for(var c in n)"default"!==c&&function(e){a.d(t,e,function(){return n[e]})}(c);t["default"]=r.a},"4c15":function(e,t,a){"use strict";a.r(t);var n=a("01d2"),r=a("1ffb");for(var c in r)"default"!==c&&function(e){a.d(t,e,function(){return r[e]})}(c);a("99ff");var o=a("2877"),i=Object(o["a"])(r["default"],n["a"],n["b"],!1,null,"fa93c2fc",null);t["default"]=i.exports},"99ff":function(e,t,a){"use strict";var n=a("eec0"),r=a.n(n);r.a},"9ff3":function(e,t,a){"use strict";(function(e,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(a("a34a")),c=o(a("0f13"));function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t,a,n,r,c,o){try{var i=e[c](o),s=i.value}catch(u){return void a(u)}i.done?t(s):Promise.resolve(s).then(n,r)}function s(e){return function(){var t=this,a=arguments;return new Promise(function(n,r){var c=e.apply(t,a);function o(e){i(c,n,r,o,s,"next",e)}function s(e){i(c,n,r,o,s,"throw",e)}o(void 0)})}}var u={data:function(){return{title:"request-payment",loading:!1,price:30,providerList:[],radio:2,modalName:null,checkbox:[{value:0,name:"微信",checked:!1,hot:!1},{value:1,name:"支付宝",checked:!1,hot:!1},{value:2,name:"英语",checked:!1,hot:!1},{value:3,name:"物理",checked:!1,hot:!1}]}},onLoad:function(){var t=this;e.getProvider({service:"payment",success:function(e){var a=[];e.provider.map(function(e){switch(e){case"alipay":a.push({name:"支付宝",id:e,loading:!1});break;case"wxpay":a.push({name:"微信",id:e,loading:!1});break;default:break}}),t.providerList=a},fail:function(e){console.log(n("获取支付通道失败：",e," at pages\\recharge\\RWrechart\\RWrechart.vue:143"))}})},methods:{weixinPay:function(){var t=this;console.log(n("发起微信支付"," at pages\\recharge\\RWrechart\\RWrechart.vue:150")),this.loading=!0,e.login({success:function(a){e.request({url:"https://unidemo.dcloud.net.cn/payment/wx/mp?code=".concat(a.code,"&amount=").concat(t.price),success:function(a){if(console.log(n("pay request success",a," at pages\\recharge\\RWrechart\\RWrechart.vue:158")),200===a.statusCode)if(0===a.data.ret){console.log(n("得到接口prepay_id",a.data.payment," at pages\\recharge\\RWrechart\\RWrechart.vue:167"));var r=a.data.payment;e.requestPayment({timeStamp:r.timeStamp,nonceStr:r.nonceStr,package:r.package,signType:"MD5",paySign:r.paySign,success:function(t){e.showToast({title:"感谢您的赞助!"})},fail:function(t){e.showModal({content:"支付失败,原因为: "+t.errMsg,showCancel:!1})},complete:function(){t.loading=!1}})}else e.showModal({content:a.data.desc,showCancel:!1});else e.showModal({content:"支付失败，请重试！",showCancel:!1})},fail:function(a){console.log(n("fail",a," at pages\\recharge\\RWrechart\\RWrechart.vue:199")),t.loading=!1,e.showModal({content:"支付失败,原因为: "+a.errMsg,showCancel:!1})}})},fail:function(a){console.log(n("fail",a," at pages\\recharge\\RWrechart\\RWrechart.vue:209")),t.loading=!1,e.showModal({content:"支付失败,原因为: "+a.errMsg,showCancel:!1})}})},requestPaymentTest:function(t){this.RWajax.post("/user/recharge",{account:e.getStorageSync("account"),coin:this.price}).then(function(t){1==t.data.success&&(e.showToast({title:"充值成功",icon:"success"}),c.default.getBalance(),setTimeout(function(){e.navigateBack({delta:1})},1e3))}).catch(function(e){console.log(n(e," at pages\\recharge\\RWrechart\\RWrechart.vue:238"))})},requestPayment:function(){var t=s(r.default.mark(function t(a,c){var o,i=this;return r.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.providerList[c].loading=!0,t.next=3,this.getOrderInfo(a.id);case 3:if(o=t.sent,console.log(n(o.data," at pages\\recharge\\RWrechart\\RWrechart.vue:275")),console.log(n("得到订单信息",o," at pages\\recharge\\RWrechart\\RWrechart.vue:276")),200===o.statusCode){t.next=10;break}return console.log(n("获得订单信息失败",o," at pages\\recharge\\RWrechart\\RWrechart.vue:278")),e.showModal({content:"获得订单信息失败",showCancel:!1}),t.abrupt("return");case 10:e.requestPayment({provider:a.id,orderInfo:o.data,success:function(t){console.log(n("success",t," at pages\\recharge\\RWrechart\\RWrechart.vue:289")),e.showToast({title:"感谢您的赞助!"})},fail:function(t){console.log(n("fail",t," at pages\\recharge\\RWrechart\\RWrechart.vue:295")),e.showModal({content:"支付失败,原因为: "+t.errMsg,showCancel:!1})},complete:function(){i.providerList[c].loading=!1}});case 11:case"end":return t.stop()}},t,this)}));function a(e,a){return t.apply(this,arguments)}return a}(),getOrderInfo:function(t){var a="";a=plus.runtime.appid;var n="https://demo.dcloud.net.cn/payment/?payid="+t+"&appid="+a+"&total="+this.price;return new Promise(function(t){e.request({url:n,success:function(e){t(e)},fail:function(e){t(e)}})})},priceChange:function(e){this.price=e.detail.value},hideModal:function(e){this.modalName=null},RadioChange:function(e){this.radio=e.detail.value},showModal:function(e){this.modalName=e.currentTarget.dataset.target}}};t.default=u}).call(this,a("6e42")["default"],a("0de9")["default"])},bd1d:function(e,t,a){"use strict";(function(e){a("85c2"),a("921b");n(a("66fd"));var t=n(a("4c15"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,a("6e42")["createPage"])},eec0:function(e,t,a){}},[["bd1d","common/runtime","common/vendor"]]]);